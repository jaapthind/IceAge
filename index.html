<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Viscous Liquid Glass OS</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        :root {
            --glass: rgba(255, 255, 255, 0.05);
            --border: rgba(255, 255, 255, 0.2);
        }

        body { margin: 0; background: #000; overflow: hidden; font-family: 'Inter', sans-serif; }
        
        /* --- THE SHADER STAGE --- */
        #canvas-holder {
            position: fixed;
            inset: 0;
            z-index: -1;
            /* This filter creates the "Liquid Merge" effect */
            filter: blur(30px) contrast(25) brightness(1.2);
            background: #000;
        }

        /* --- RAINBOW REFRACTION OVERLAY --- */
        #glass-overlay {
            position: fixed;
            inset: 0;
            z-index: 1;
            pointer-events: none;
            background: linear-gradient(135deg, rgba(255,255,255,0.05) 0%, transparent 100%);
            /* Adds the chromatic rainbow edges */
            filter: url(#rainbow-chroma);
        }

        #ui-layer {
            position: relative;
            z-index: 10;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 30px;
            padding: 20px;
        }

        .panel {
            background: var(--glass);
            backdrop-filter: blur(40px) saturate(150%);
            -webkit-backdrop-filter: blur(40px);
            border: 1px solid var(--border);
            border-radius: 35px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.4);
            color: white;
        }

        #chat-window { width: 380px; height: 500px; overflow: hidden; }
        iframe { width: 100%; height: 100%; border: none; opacity: 0.8; }

        #boot-screen {
            position: fixed; inset: 0; background: #000; z-index: 9999;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            transition: 0.8s;
        }
        button {
            padding: 15px 40px; background: #fff; border-radius: 50px;
            font-weight: 900; border: none; cursor: pointer; font-size: 14px;
        }
    </style>
</head>
<body>

    <div id="boot-screen">
        <h2 style="color:white; letter-spacing:5px; margin-bottom:20px;">VISCOUS_LINK_V10</h2>
        <button onclick="startApp()">START ENGINE</button>
    </div>

    <svg style="position: absolute; width:0; height:0;">
      <filter id="rainbow-chroma">
        <feColorMatrix type="matrix" values="1 0 0 0 0  0 0 0 0 0  0 0 0 0 0  0 0 0 1 0" result="red"/>
        <feColorMatrix type="matrix" values="0 0 0 0 0  0 1 0 0 0  0 0 0 0 0  0 0 0 1 0" result="green" in="SourceGraphic"/>
        <feColorMatrix type="matrix" values="0 0 0 0 0  0 0 0 0 0  0 0 1 0 0  0 0 0 1 0" result="blue" in="SourceGraphic"/>
        <feOffset in="red" dx="3" dy="0" result="redShifted"/>
        <feOffset in="blue" dx="-3" dy="0" result="blueShifted"/>
        <feBlend in="redShifted" in2="green" mode="screen" result="temp"/>
        <feBlend in="temp" in2="blueShifted" mode="screen"/>
      </filter>
    </svg>

    <div id="canvas-holder"></div>
    <div id="glass-overlay"></div>

    <div id="ui-layer">
        <div class="panel" style="padding: 25px; width: 280px;">
            <h3 style="font-size: 10px; letter-spacing: 3px; opacity: 0.5;">FLUID_SENSORS</h3>
            <p style="font-size: 12px; margin-top: 15px;">Viscosity: <b>HEAVY</b></p>
            <p style="font-size: 12px;">Refraction: <b>ULTRA</b></p>
            <div style="margin-top: 20px; font-size: 10px; color: #aaa;">
                STABLE_MOLTEN_FLOW: ACTIVE
            </div>
        </div>

        <div class="panel" id="chat-window">
            <iframe src="https://deadsimplechat.com/J4fFLy4Ek"></iframe>
        </div>
    </div>

<script>
    let particles = [];
    let video;
    let isStarted = false;

    function setup() {
        let cnv = createCanvas(windowWidth, windowHeight);
        cnv.parent('canvas-holder');
        
        // Setup Webcam for the "Glass Texture"
        video = createCapture(VIDEO);
        video.size(640, 480);
        video.hide();

        // Create heavy, slow-moving blobs
        for (let i = 0; i < 8; i++) {
            particles.push(new MoltenBlob());
        }
    }

    function startApp() {
        document.getElementById('boot-screen').style.opacity = '0';
        setTimeout(() => {
            document.getElementById('boot-screen').remove();
            isStarted = true;
        }, 800);
    }

    function draw() {
        if (!isStarted) return;
        clear();

        // Track window shake for momentum
        let windowShake = abs(window.screenX - pmouseX); 

        for (let p of particles) {
            p.update();
            p.display();
        }
    }

    class MoltenBlob {
        constructor() {
            this.pos = createVector(random(width), height + 200);
            this.vel = createVector(random(-2, 2), random(-1, -3));
            this.radius = random(180, 300);
            this.hueOffset = random(360);
        }

        update() {
            // Viscous Physics: slow, curved movement
            let noiseVal = noise(this.pos.x * 0.005, this.pos.y * 0.005, frameCount * 0.01);
            let angle = map(noiseVal, 0, 1, 0, TWO_PI * 2);
            
            let steer = createVector(cos(angle), sin(angle));
            this.vel.add(steer.mult(0.1));
            this.vel.limit(2.5); // Keep it slow and thick
            
            this.pos.add(this.vel);

            // Gravity/Bottom pooling
            if (this.pos.y > height - 100) {
                this.vel.y -= 0.2;
            }

            // Screen wrap
            if (this.pos.x < -this.radius) this.pos.x = width + this.radius;
            if (this.pos.x > width + this.radius) this.pos.x = -this.radius;
            if (this.pos.y < -this.radius) this.pos.y = height + this.radius;
        }

        display() {
            push();
            translate(this.pos.x, this.pos.y);
            
            // Draw the webcam feed "inside" the blob for that realistic refraction
            noStroke();
            drawingContext.clip(); // Only show webcam inside the curved shape
            
            // Apply rainbow hue rotation
            let h = (frameCount + this.hueOffset) % 360;
            tint(255, 200); // Slight transparency
            
            // Draw distorted webcam feed
            image(video, -this.radius, -this.radius, this.radius * 2, this.radius * 2);
            
            pop();
            
            // Simple white specular highlight to make it look like glass
            fill(255, 30);
            ellipse(this.pos.x - this.radius/3, this.pos.y - this.radius/3, this.radius/2);
        }
    }

    function windowResized() {
        resizeCanvas(windowWidth, windowHeight);
    }
</script>

</body>
</html>
